<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Password Strength Analyzer</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body {
      background: radial-gradient(circle at top, #0f172a, #020617);
    }
    @keyframes fade-in {
      from { opacity: 0; transform: translateY(6px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in { animation: fade-in 0.3s ease-out; }
  </style>
</head>

<body class="text-white min-h-screen flex items-center justify-center px-6">

<div class="w-full max-w-xl bg-zinc-900/70 p-6 rounded-xl border border-zinc-800">

  <h1 class="text-2xl font-bold mb-6 text-center">
    üìä Password Strength Analyzer
  </h1>

  <input
    type="password"
    id="password"
    placeholder="Type password to analyze"
    class="w-full p-2 mb-4 rounded bg-zinc-800 text-white"
    oninput="debouncedCheck()"
  />

  <!-- STRENGTH BAR -->
  <div class="w-full bg-zinc-800 rounded h-2 mb-4 overflow-hidden">
    <div
      id="strengthBar"
      class="h-2 w-0 transition-all duration-300"
    ></div>
  </div>

  <div id="result" class="text-sm text-center min-h-[80px]"></div>

  <!-- NAVIGATION -->
  <div class="mt-6 flex flex-col md:flex-row gap-4 justify-center text-sm">
    <a href="token.html" class="px-4 py-2 rounded bg-zinc-800 hover:bg-zinc-700">‚Üê Password Generator</a>
    <a href="hash.html" class="px-4 py-2 rounded bg-zinc-800 hover:bg-zinc-700">‚Üí Hash Generator</a>
    <a href="index.html" class="px-4 py-2 rounded bg-zinc-800 hover:bg-zinc-700">‚åÇ Home</a>
  </div>

</div>

<script>
let timer;

function labelFromScore(score) {
  if (score < 30) return ["Weak", "bg-red-500", "text-red-400"];
  if (score < 60) return ["Medium", "bg-yellow-400", "text-yellow-400"];
  if (score < 80) return ["Strong", "bg-green-500", "text-green-400"];
  return ["Super Strong", "bg-cyan-400", "text-cyan-400"];
}

function debouncedCheck() {
  clearTimeout(timer);
  timer = setTimeout(checkStrength, 300);
}

async function checkStrength() {
  const password = document.getElementById("password").value;
  const result = document.getElementById("result");
  const bar = document.getElementById("strengthBar");

  if (!password) {
    result.innerHTML = "";
    bar.style.width = "0%";
    bar.className = "h-2";
    return;
  }

  const res = await fetch("http://127.0.0.1:5000/api/password-strength", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ password })
  });

  const data = await res.json();
  const [label, barColor, textColor] = labelFromScore(data.score);

  bar.style.width = Math.min(data.score, 100) + "%";
  bar.className = `h-2 ${barColor}`;

  result.innerHTML = `
    <div class="animate-fade-in">
      <p class="text-lg font-semibold ${textColor}">${label}</p>
      <p class="text-sm mt-1">
        Estimated crack time:
        <span class="font-mono animate-pulse">${data.crack_time}</span>
      </p>
    </div>
  `;
}

/* Auto-load from generator */
window.onload = () => {
  const stored = sessionStorage.getItem("passwordToCheck");
  if (stored) {
    document.getElementById("password").value = stored;
    sessionStorage.removeItem("passwordToCheck");
    debouncedCheck();
  }
};
</script>

</body>
</html>
